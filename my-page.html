<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì´í˜ì´ì§€ - PlantiaWorld</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-bottom: 50px;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab-button {
            padding: 16px;
            border-radius: 12px;
            transition: all 0.3s;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 90px;
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: white;
            border-color: #10b981;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-card {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal.active { display: flex; }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            z-index: 3000;
            animation: slideIn 0.3s ease-out;
        }

        .toast-success { border-left: 4px solid #10b981; }
        .toast-error { border-left: 4px solid #ef4444; }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .product-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .profile-image-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto;
        }

        .profile-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .upload-overlay {
            position: absolute;
            bottom: 0;
            right: 0;
            background: #10b981;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.2s;
        }

        .upload-overlay:hover {
            background: #059669;
            transform: scale(1.1);
        }

        .badge-level {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-beginner { background: #dbeafe; color: #1e40af; }
        .badge-expert { background: #fef3c7; color: #92400e; }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #10b981;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #10b981;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        @media (max-width: 768px) {
            .product-card img { height: 150px; }
            .stat-card { padding: 16px; }
        }
    </style>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged, 
            signOut,
            updatePassword,
            EmailAuthProvider,
            reauthenticateWithCredential,
            deleteUser,
            updateProfile
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            getDoc, 
            updateDoc, 
            setDoc,
            collection, 
            query, 
            where, 
            getDocs,
            deleteDoc,
            orderBy,
            limit,
            serverTimestamp
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { 
            getStorage, 
            ref, 
            uploadBytes, 
            getDownloadURL 
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        const firebaseConfig = {
           apiKey: "AIzaSyAW_z3hoI9SZ1-hoxKVYBKs7rbdo8n6wdc",
           authDomain: "plantiaworld.firebaseapp.com",
           projectId: "plantiaworld",
           storageBucket: "plantiaworld.firebasestorage.app",
           messagingSenderId: "18112813073",
           appId: "1:18112813073:web:7247046c038a3831db79b0",
           measurementId: "G-8XSSM279KY"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        let currentUser = null;
        let userProfile = null;

        window.firebaseModules = { db, auth, storage };

        // ========== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ==========
        function escapeHtml(text) {
            if (!text) return '';
            const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
            return String(text).replace(/[&<>"']/g, m => map[m]);
        }

        function showToast(message, type = 'success') {
            const existingToast = document.querySelector('.toast');
            if (existingToast) existingToast.remove();
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
                ${escapeHtml(message)}
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.remove(), 3000);
        }

        // ========== ì¸ì¦ ìƒíƒœ í™•ì¸ ==========
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                console.log('ë¡œê·¸ì¸ëœ ì‚¬ìš©ì:', user.uid);
                console.log('ì‚¬ìš©ì ì´ë©”ì¼:', user.email);
                await loadUserProfile(user);
                document.getElementById('loadingScreen').classList.add('hidden');
            } else {
                console.log('ë¹„ë¡œê·¸ì¸ ìƒíƒœ - ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™');
                window.location.href = 'login.html';
            }
        });

        // ========== ì‚¬ìš©ì í”„ë¡œí•„ ë¡œë“œ ==========
        async function loadUserProfile(user) {
            try {
                console.log('í”„ë¡œí•„ ë¡œë“œ ì‹œì‘:', user.uid);
                const userDocRef = doc(db, 'users', user.uid);
                const userSnap = await getDoc(userDocRef);
                
                if (userSnap.exists()) {
                    userProfile = userSnap.data();
                    console.log('ì‚¬ìš©ì í”„ë¡œí•„:', userProfile);
                } else {
                    console.log('ì‚¬ìš©ì ë¬¸ì„œ ì—†ìŒ - ìƒˆë¡œ ìƒì„±');
                    // ì‚¬ìš©ì ë¬¸ì„œê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ ì •ë³´ë¡œ ìƒì„±
                    await setDoc(userDocRef, {
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName || user.email.split('@')[0],
                        photoURL: user.photoURL || '',
                        createdAt: serverTimestamp(),
                        subscription: 'Free',
                        location: '',
                        settings: {
                            notifications: true,
                            emailAlerts: false,
                            darkMode: false,
                            language: 'ko'
                        }
                    });
                    
                    // ë‹¤ì‹œ ë¡œë“œ
                    const newSnap = await getDoc(userDocRef);
                    userProfile = newSnap.data();
                }
                
                // UI ì—…ë°ì´íŠ¸
                updateProfileUI(user);
                
                // í†µê³„ ë¡œë“œ
                await loadStatistics(user.uid);
                
                // í™˜ê²½ ì„¤ì • ë¡œë“œ
                loadSettings();
                
                // ë‚´ ì‹ë¬¼ ë¡œë“œ
                await loadMyPlants(user.uid);
                
                // ì¢‹ì•„ìš” ëª©ë¡ ë¡œë“œ
                await loadLikedProducts(user.uid);
                
            } catch (error) {
                console.error('í”„ë¡œí•„ ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ========== UI ì—…ë°ì´íŠ¸ ==========
        function updateProfileUI(user) {
            // ê¸°ë³¸ í”„ë¡œí•„ ì •ë³´
            const displayName = userProfile?.displayName || userProfile?.username || user.displayName || user.email.split('@')[0];
            document.getElementById('userName').textContent = displayName;
            document.getElementById('userEmail').textContent = user.email;
            document.getElementById('userEmail2').textContent = user.email;
            document.getElementById('userRealName').textContent = userProfile?.realName || displayName;
            
            // ê°€ì…ì¼
            let joinDate;
            if (userProfile?.createdAt && userProfile.createdAt.seconds) {
                joinDate = new Date(userProfile.createdAt.seconds * 1000).toLocaleDateString('ko-KR');
            } else {
                joinDate = new Date(user.metadata.creationTime).toLocaleDateString('ko-KR');
            }
            document.getElementById('joinDate').textContent = joinDate;
            
            // í”„ë¡œí•„ ì´ë¯¸ì§€
            const profileImageUrl = user.photoURL || userProfile?.photoURL || userProfile?.profileImage || 'data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Crect width='120' height='120' fill='%23e5e7eb'/%3E%3Ccircle cx='60' cy='45' r='22' fill='%23d1d5db'/%3E%3Cellipse cx='60' cy='90' rx='35' ry='25' fill='%23d1d5db'/%3E%3C/svg%3E';
            document.getElementById('profileImage').src = profileImageUrl;
            document.getElementById('headerProfileImage').src = profileImageUrl;
            
            // êµ¬ë… ì •ë³´
            const subscription = userProfile?.subscription || 'Free';
            document.getElementById('currentPlan').textContent = subscription;
            document.getElementById('planBadge').textContent = subscription;
            document.getElementById('planBadge').className = 
                subscription === 'Pro' ? 'badge-level badge-expert' : 'badge-level badge-beginner';
            
            // ìœ„ì¹˜ ì •ë³´ - ë¬¸ìì—´ ë˜ëŠ” ê°ì²´ ëª¨ë‘ ì²˜ë¦¬
            let locationText = 'ë¯¸ì„¤ì •';
            const loc = userProfile?.location;
            if (loc) {
                if (typeof loc === 'string') locationText = loc;
                else if (loc.address) locationText = loc.address;
                else if (typeof loc === 'object' && (loc.latitude || loc.lat)) {
                    locationText = `ìœ„ë„ ${(loc.latitude || loc.lat).toFixed(4)}, ê²½ë„ ${(loc.longitude || loc.lng).toFixed(4)}`;
                }
            }
            document.getElementById('userLocation').textContent = locationText;
        }

        // ========== í†µê³„ ë¡œë“œ ==========
        async function loadStatistics(uid) {
            try {
                console.log('í†µê³„ ë¡œë“œ ì‹œì‘:', uid);
                
                // ë“±ë¡í•œ ì‹ë¬¼ ìˆ˜
                const myPlantsQuery = query(collection(db, 'products'), where('sellerId', '==', uid));
                const myPlantsSnap = await getDocs(myPlantsQuery);
                const myPlantsCount = myPlantsSnap.size;
                document.getElementById('statMyPlants').textContent = myPlantsCount;
                console.log('ë“±ë¡í•œ ì‹ë¬¼:', myPlantsCount);
                
                // íŒë§¤ ì™„ë£Œ ìˆ˜
                const soldQuery = query(
                    collection(db, 'products'), 
                    where('sellerId', '==', uid),
                    where('status', '==', 'íŒë§¤ì™„ë£Œ')
                );
                const soldSnap = await getDocs(soldQuery);
                const soldCount = soldSnap.size;
                document.getElementById('statSold').textContent = soldCount;
                console.log('íŒë§¤ ì™„ë£Œ:', soldCount);
                
                // ì¢‹ì•„ìš” ë°›ì€ ìˆ˜
                let totalLikes = 0;
                myPlantsSnap.forEach(doc => {
                    const data = doc.data();
                    totalLikes += (data.likeCount || 0);
                });
                document.getElementById('statLikes').textContent = totalLikes;
                console.log('ë°›ì€ ì¢‹ì•„ìš”:', totalLikes);
                
                // ë¦¬ë·° ìˆ˜ (ì„ì‹œ)
                document.getElementById('statReviews').textContent = '0';
                
            } catch (error) {
                console.error('í†µê³„ ë¡œë“œ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ì‹œ 0ìœ¼ë¡œ í‘œì‹œ
                document.getElementById('statMyPlants').textContent = '0';
                document.getElementById('statSold').textContent = '0';
                document.getElementById('statLikes').textContent = '0';
                document.getElementById('statReviews').textContent = '0';
            }
        }

        // ========== í™˜ê²½ ì„¤ì • ë¡œë“œ ==========
        function loadSettings() {
            const settings = userProfile?.settings || {
                notifications: true,
                emailAlerts: false,
                darkMode: false,
                language: 'ko'
            };
            
            console.log('í™˜ê²½ ì„¤ì • ë¡œë“œ:', settings);
            
            document.getElementById('settingNotifications').checked = settings.notifications !== false;
            document.getElementById('settingEmailAlerts').checked = settings.emailAlerts === true;
            document.getElementById('settingDarkMode').checked = settings.darkMode === true;
            document.getElementById('settingLanguage').value = settings.language || 'ko';
        }

        // ========== ë‚´ ì‹ë¬¼ ë¡œë“œ ==========
        async function loadMyPlants(uid) {
            try {
                console.log('ë‚´ ì‹ë¬¼ ë¡œë“œ ì‹œì‘:', uid);
                const container = document.getElementById('myPlantsList');
                container.innerHTML = '<div class="col-span-full"><div class="loading-spinner"></div></div>';
                
                const q = query(
                    collection(db, 'products'),
                    where('sellerId', '==', uid),
                    orderBy('createdAt', 'desc'),
                    limit(50)
                );
                
                const snapshot = await getDocs(q);
                console.log('ë‚´ ì‹ë¬¼ ê°œìˆ˜:', snapshot.size);
                
                if (snapshot.empty) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-seedling text-6xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500 text-lg mb-4">ë“±ë¡í•œ ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            <a href="add-product.html" class="inline-block bg-green-600 text-white px-6 py-3 rounded-xl hover:bg-green-700 transition">
                                <i class="fas fa-plus mr-2"></i>ì‹ë¬¼ ë“±ë¡í•˜ê¸°
                            </a>
                        </div>
                    `;
                    return;
                }
                
                const products = [];
                snapshot.forEach(doc => {
                    products.push({ id: doc.id, ...doc.data() });
                });
                
                container.innerHTML = products.map(product => createProductCard(product)).join('');
                
            } catch (error) {
                console.error('ë‚´ ì‹ë¬¼ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('myPlantsList').innerHTML = `
                    <div class="col-span-full text-center py-12 text-red-500">
                        <i class="fas fa-exclamation-triangle text-6xl mb-4"></i>
                        <p class="text-lg">ì‹ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                        <p class="text-sm mt-2">${escapeHtml(error.message)}</p>
                    </div>
                `;
            }
        }

        // ========== ì¢‹ì•„ìš”í•œ ì‹ë¬¼ ë¡œë“œ ==========
        async function loadLikedProducts(uid) {
            try {
                console.log('ì¢‹ì•„ìš” ëª©ë¡ ë¡œë“œ ì‹œì‘:', uid);
                const container = document.getElementById('likedProductsList');
                container.innerHTML = '<div class="col-span-full"><div class="loading-spinner"></div></div>';
                
                const q = query(
                    collection(db, 'products'),
                    where('likedBy', 'array-contains', uid),
                    orderBy('createdAt', 'desc'),
                    limit(50)
                );
                
                const snapshot = await getDocs(q);
                console.log('ì¢‹ì•„ìš” ì‹ë¬¼ ê°œìˆ˜:', snapshot.size);
                
                if (snapshot.empty) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="far fa-heart text-6xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500 text-lg mb-4">ì¢‹ì•„ìš”í•œ ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            <a href="index.html" class="inline-block bg-green-600 text-white px-6 py-3 rounded-xl hover:bg-green-700 transition">
                                <i class="fas fa-search mr-2"></i>ì‹ë¬¼ ë‘˜ëŸ¬ë³´ê¸°
                            </a>
                        </div>
                    `;
                    return;
                }
                
                const products = [];
                snapshot.forEach(doc => {
                    products.push({ id: doc.id, ...doc.data() });
                });
                
                container.innerHTML = products.map(product => createProductCard(product)).join('');
                
            } catch (error) {
                console.error('ì¢‹ì•„ìš” ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('likedProductsList').innerHTML = `
                    <div class="col-span-full text-center py-12 text-red-500">
                        <i class="fas fa-exclamation-triangle text-6xl mb-4"></i>
                        <p class="text-lg">ì¢‹ì•„ìš” ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                        <p class="text-sm mt-2">${escapeHtml(error.message)}</p>
                    </div>
                `;
            }
        }

        // ========== ìƒí’ˆ ì¹´ë“œ ìƒì„± ==========
        function createProductCard(product) {
            const price = product.price === 0 ? 'ë‚˜ëˆ” ğŸŒ±' : `${(product.price || 0).toLocaleString()}ì›`;
            const image = product.images && product.images[0] ? product.images[0] : 'data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Crect width='200' height='200' fill='%23f3f4f6'/%3E%3Ctext x='100' y='105' text-anchor='middle' fill='%239ca3af' font-size='14' font-family='sans-serif'%3Eì´ë¯¸ì§€ ì—†ìŒ%3C/text%3E%3C/svg%3E';
            const status = product.status || 'íŒë§¤ì¤‘';
            const statusClass = status === 'íŒë§¤ì¤‘' ? 'bg-blue-500' : status === 'ì˜ˆì•½ì¤‘' ? 'bg-orange-500' : 'bg-red-500';
            
            return `
                <div class="product-card" onclick="window.location.href='product-detail.html?id=${product.id}'">
                    <div class="relative">
                        <img src="${escapeHtml(image)}" alt="${escapeHtml(product.title || 'ìƒí’ˆ')}" onerror="this.src='data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Crect width='200' height='200' fill='%23f3f4f6'/%3E%3Ctext x='100' y='105' text-anchor='middle' fill='%239ca3af' font-size='14' font-family='sans-serif'%3Eì´ë¯¸ì§€ ì—†ìŒ%3C/text%3E%3C/svg%3E'">
                        <div class="absolute top-2 left-2">
                            <span class="${statusClass} text-white text-xs px-3 py-1 rounded-full font-semibold">
                                ${status}
                            </span>
                        </div>
                    </div>
                    <div class="p-4">
                        <h4 class="font-bold text-sm mb-1 truncate">${escapeHtml(product.title || 'ì œëª© ì—†ìŒ')}</h4>
                        <p class="text-green-600 font-bold text-sm mb-2">${price}</p>
                        <p class="text-xs text-gray-500 mb-2">${escapeHtml(product.sellerLocation || product.location || 'ìœ„ì¹˜ ë¯¸ìƒ')}</p>
                        <div class="flex items-center gap-3 text-xs text-gray-400">
                            <span><i class="far fa-heart"></i> ${product.likeCount || 0}</span>
                            <span><i class="far fa-comment"></i> ${product.chatCount || 0}</span>
                            <span><i class="far fa-eye"></i> ${product.views || 0}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // ========== íƒ­ ì „í™˜ ==========
        window.switchTab = function(tabName) {
            console.log('íƒ­ ì „í™˜:', tabName);
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¹€
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            const tabButton = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
            if (tabButton) tabButton.classList.add('active');
            
            const tabContent = document.getElementById(`content-${tabName}`);
            if (tabContent) tabContent.classList.add('active');
        };

        // ========== í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ==========
        window.uploadProfileImage = async function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            console.log('í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œì‘:', file.name);
            
            // íŒŒì¼ í¬ê¸° ì²´í¬ (5MB)
            if (file.size > 5 * 1024 * 1024) {
                showToast('íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤', 'error');
                return;
            }
            
            // ì´ë¯¸ì§€ íŒŒì¼ ì²´í¬
            if (!file.type.startsWith('image/')) {
                showToast('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤', 'error');
                return;
            }
            
            try {
                showToast('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì¤‘...', 'success');
                
                // Firebase Storageì— ì—…ë¡œë“œ
                const storageRef = ref(storage, `profile-images/${currentUser.uid}/${Date.now()}_${file.name}`);
                const snapshot = await uploadBytes(storageRef, file);
                const downloadURL = await getDownloadURL(snapshot.ref);
                
                console.log('ì—…ë¡œë“œ ì™„ë£Œ:', downloadURL);
                
                // Firestore ì—…ë°ì´íŠ¸
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    photoURL: downloadURL,
                    profileImage: downloadURL,
                    updatedAt: serverTimestamp()
                });
                
                // Auth í”„ë¡œí•„ ì—…ë°ì´íŠ¸
                await updateProfile(currentUser, {
                    photoURL: downloadURL
                });
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('profileImage').src = downloadURL;
                document.getElementById('headerProfileImage').src = downloadURL;
                
                showToast('í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        };

        // ========== í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° ==========
        window.openEditProfile = function() {
            console.log('í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°');
            document.getElementById('editUsername').value = userProfile?.displayName || userProfile?.username || '';
            document.getElementById('editRealName').value = userProfile?.realName || userProfile?.displayName || '';
            document.getElementById('editLocation').value = userProfile?.location || '';
            document.getElementById('editProfileModal').classList.add('active');
        };

        // ========== í”„ë¡œí•„ ì €ì¥ ==========
        window.saveProfile = async function() {
            const username = document.getElementById('editUsername').value.trim();
            const realName = document.getElementById('editRealName').value.trim();
            const location = document.getElementById('editLocation').value.trim();
            
            console.log('í”„ë¡œí•„ ì €ì¥:', { username, realName, location });
            
            if (!username) {
                showToast('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            try {
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    displayName: username,
                    username: username,
                    realName: realName,
                    location: location,
                    updatedAt: serverTimestamp()
                });
                
                // Auth í”„ë¡œí•„ë„ ì—…ë°ì´íŠ¸
                await updateProfile(currentUser, {
                    displayName: username
                });
                
                showToast('í”„ë¡œí•„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                closeModal('editProfileModal');
                
                // í”„ë¡œí•„ ë‹¤ì‹œ ë¡œë“œ
                await loadUserProfile(currentUser);
                
            } catch (error) {
                console.error('í”„ë¡œí•„ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('í”„ë¡œí•„ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        };

        // ========== í™˜ê²½ ì„¤ì • ì €ì¥ ==========
        window.saveSettings = async function() {
            try {
                const settings = {
                    notifications: document.getElementById('settingNotifications').checked,
                    emailAlerts: document.getElementById('settingEmailAlerts').checked,
                    darkMode: document.getElementById('settingDarkMode').checked,
                    language: document.getElementById('settingLanguage').value
                };
                
                console.log('ì„¤ì • ì €ì¥:', settings);
                
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    settings: settings,
                    updatedAt: serverTimestamp()
                });
                
                showToast('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                
                // ë‹¤í¬ëª¨ë“œ ì ìš©
                if (settings.darkMode) {
                    document.body.classList.add('dark');
                } else {
                    document.body.classList.remove('dark');
                }
                
            } catch (error) {
                console.error('ì„¤ì • ì €ì¥ ì˜¤ë¥˜:', error);
                showToast('ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        };

        // ========== ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ==========
        window.changePassword = async function() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            console.log('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œë„');
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                showToast('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showToast('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            if (newPassword.length < 6) {
                showToast('ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤', 'error');
                return;
            }
            
            try {
                // ì¬ì¸ì¦
                const credential = EmailAuthProvider.credential(currentUser.email, currentPassword);
                await reauthenticateWithCredential(currentUser, credential);
                
                // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
                await updatePassword(currentUser, newPassword);
                
                showToast('ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                closeModal('changePasswordModal');
                
                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
            } catch (error) {
                console.error('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì˜¤ë¥˜:', error);
                if (error.code === 'auth/wrong-password') {
                    showToast('í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤', 'error');
                } else if (error.code === 'auth/weak-password') {
                    showToast('ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì•½í•©ë‹ˆë‹¤', 'error');
                } else {
                    showToast('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                }
            }
        };

        // ========== ê³„ì • ì‚­ì œ ==========
        window.deleteAccount = async function() {
            console.log('ê³„ì • ì‚­ì œ ì‹œë„');
            
            if (!confirm('ì •ë§ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ê²½ê³ :\n- ëª¨ë“  ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤\n- ë“±ë¡í•œ ì‹ë¬¼, ì±„íŒ… ê¸°ë¡ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤\n- ë³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤')) {
                return;
            }
            
            const password = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
            if (!password) {
                showToast('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤', 'error');
                return;
            }
            
            try {
                showToast('ê³„ì • ì‚­ì œ ì¤‘...', 'success');
                
                // ì¬ì¸ì¦
                const credential = EmailAuthProvider.credential(currentUser.email, password);
                await reauthenticateWithCredential(currentUser, credential);
                
                // ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ
                await deleteDoc(doc(db, 'users', currentUser.uid));
                
                // ì‚¬ìš©ì ìƒí’ˆ ì‚­ì œ
                const productsQuery = query(collection(db, 'products'), where('sellerId', '==', currentUser.uid));
                const productsSnap = await getDocs(productsQuery);
                const deletePromises = [];
                productsSnap.forEach(productDoc => {
                    deletePromises.push(deleteDoc(productDoc.ref));
                });
                await Promise.all(deletePromises);
                
                // ê³„ì • ì‚­ì œ
                await deleteUser(currentUser);
                
                showToast('íšŒì› íƒˆí‡´ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
                
            } catch (error) {
                console.error('ê³„ì • ì‚­ì œ ì˜¤ë¥˜:', error);
                if (error.code === 'auth/wrong-password') {
                    showToast('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤', 'error');
                } else if (error.code === 'auth/requires-recent-login') {
                    showToast('ë³´ì•ˆì„ ìœ„í•´ ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”', 'error');
                } else {
                    showToast('íšŒì› íƒˆí‡´ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                }
            }
        };

        // ========== ë¡œê·¸ì•„ì›ƒ ==========
        window.handleLogout = async function() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    console.log('ë¡œê·¸ì•„ì›ƒ ì‹œë„');
                    await signOut(auth);
                    showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1000);
                } catch (error) {
                    console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                    showToast('ë¡œê·¸ì•„ì›ƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                }
            }
        };

        // ========== ëª¨ë‹¬ ì œì–´ ==========
        window.closeModal = function(modalId) {
            document.getElementById(modalId).classList.remove('active');
        };

        window.openModal = function(modalId) {
            document.getElementById(modalId).classList.add('active');
        };

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // ========== í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ==========
        console.log('ë§ˆì´í˜ì´ì§€ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');

    </script>
</head>
<body>
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loadingScreen" class="fixed inset-0 bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center z-50">
        <div class="text-center text-white">
            <div class="loading-spinner mb-4"></div>
            <p class="text-lg font-medium">í”„ë¡œí•„ ë¡œë”© ì¤‘...</p>
        </div>
    </div>

    <!-- í—¤ë” -->
    <header class="glass-card sticky top-0 z-40">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <button onclick="window.location.href='index.html'" class="text-gray-600 hover:text-gray-800 transition" title="í™ˆìœ¼ë¡œ">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <h1 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-user-circle mr-2 text-green-600"></i>ë§ˆì´í˜ì´ì§€
                </h1>
                <button onclick="handleLogout()" class="text-gray-600 hover:text-red-600 transition" title="ë¡œê·¸ì•„ì›ƒ">
                    <i class="fas fa-sign-out-alt text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <main class="container mx-auto px-4 py-6 max-w-6xl">
        <!-- í”„ë¡œí•„ ì¹´ë“œ -->
        <div class="glass-card rounded-3xl p-8 mb-6">
            <div class="flex flex-col md:flex-row items-center gap-6">
                <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
                <div class="profile-image-container">
                    <img id="profileImage" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Crect width='120' height='120' fill='%23e5e7eb'/%3E%3Ccircle cx='60' cy='45' r='22' fill='%23d1d5db'/%3E%3Cellipse cx='60' cy='90' rx='35' ry='25' fill='%23d1d5db'/%3E%3C/svg%3E" alt="í”„ë¡œí•„" class="profile-image">
                    <label class="upload-overlay" title="í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½">
                        <i class="fas fa-camera text-white"></i>
                        <input type="file" accept="image/*" onchange="uploadProfileImage(event)" class="hidden">
                    </label>
                </div>
                
                <!-- í”„ë¡œí•„ ì •ë³´ -->
                <div class="flex-1 text-center md:text-left">
                    <div class="flex items-center gap-2 justify-center md:justify-start mb-2 flex-wrap">
                        <h2 id="userName" class="text-2xl font-bold text-gray-800">ì‚¬ìš©ì</h2>
                        <span id="planBadge" class="badge-level badge-beginner">Free</span>
                    </div>
                    <p id="userEmail" class="text-gray-600 mb-1">
                        <i class="fas fa-envelope mr-1"></i><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6114120413210419000c110d044f020e0c">[email&#160;protected]</a>
                    </p>
                    <p class="text-gray-500 text-sm mb-4">
                        <i class="fas fa-map-marker-alt mr-1"></i>
                        <span id="userLocation">ë¯¸ì„¤ì •</span>
                    </p>
                    <button onclick="openEditProfile()" class="bg-green-600 text-white px-6 py-2 rounded-xl hover:bg-green-700 transition shadow-lg">
                        <i class="fas fa-edit mr-2"></i>í”„ë¡œí•„ ìˆ˜ì •
                    </button>
                </div>
            </div>
            
            <!-- í†µê³„ -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8">
                <div class="stat-card text-center">
                    <div class="text-3xl font-bold mb-1" id="statMyPlants">0</div>
                    <div class="text-sm opacity-90">ë“±ë¡í•œ ì‹ë¬¼</div>
                </div>
                <div class="stat-card text-center">
                    <div class="text-3xl font-bold mb-1" id="statSold">0</div>
                    <div class="text-sm opacity-90">íŒë§¤ ì™„ë£Œ</div>
                </div>
                <div class="stat-card text-center">
                    <div class="text-3xl font-bold mb-1" id="statLikes">0</div>
                    <div class="text-sm opacity-90">ë°›ì€ ì¢‹ì•„ìš”</div>
                </div>
                <div class="stat-card text-center">
                    <div class="text-3xl font-bold mb-1" id="statReviews">0</div>
                    <div class="text-sm opacity-90">ë¦¬ë·°</div>
                </div>
            </div>
        </div>

        <!-- íƒ­ ë©”ë‰´ -->
        <div class="glass-card rounded-3xl p-4 mb-6">
            <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
                <button class="tab-button active" onclick="switchTab('plants')">
                    <i class="fas fa-seedling text-green-600 text-2xl mb-2"></i>
                    <p class="text-sm font-medium text-gray-700">ë‚´ ì‹ë¬¼</p>
                </button>
                <button class="tab-button" onclick="switchTab('likes')">
                    <i class="fas fa-heart text-red-500 text-2xl mb-2"></i>
                    <p class="text-sm font-medium text-gray-700">ì¢‹ì•„ìš”</p>
                </button>
                <button class="tab-button" onclick="switchTab('settings')">
                    <i class="fas fa-cog text-blue-600 text-2xl mb-2"></i>
                    <p class="text-sm font-medium text-gray-700">ì„¤ì •</p>
                </button>
                <button class="tab-button" onclick="switchTab('security')">
                    <i class="fas fa-shield-alt text-purple-600 text-2xl mb-2"></i>
                    <p class="text-sm font-medium text-gray-700">ë³´ì•ˆ</p>
                </button>
                <button class="tab-button" onclick="switchTab('subscription')">
                    <i class="fas fa-crown text-yellow-500 text-2xl mb-2"></i>
                    <p class="text-sm font-medium text-gray-700">êµ¬ë…</p>
                </button>
            </div>
        </div>

        <!-- íƒ­ ì½˜í…ì¸  ì˜ì—­ -->
        <div>
            <!-- ë‚´ ì‹ë¬¼ íƒ­ -->
            <div id="content-plants" class="tab-content active">
                <div class="glass-card rounded-3xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-seedling text-green-600 mr-2"></i>ë‚´ê°€ ë“±ë¡í•œ ì‹ë¬¼
                        </h3>
                        <a href="add-product.html" class="bg-green-600 text-white px-4 py-2 rounded-xl hover:bg-green-700 transition shadow-lg">
                            <i class="fas fa-plus mr-2"></i>ë“±ë¡í•˜ê¸°
                        </a>
                    </div>
                    <div id="myPlantsList" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="col-span-full">
                            <div class="loading-spinner"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì¢‹ì•„ìš” íƒ­ -->
            <div id="content-likes" class="tab-content">
                <div class="glass-card rounded-3xl p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-heart text-red-500 mr-2"></i>ì¢‹ì•„ìš”í•œ ì‹ë¬¼
                    </h3>
                    <div id="likedProductsList" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="col-span-full">
                            <div class="loading-spinner"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- í™˜ê²½ ì„¤ì • íƒ­ -->
            <div id="content-settings" class="tab-content">
                <div class="glass-card rounded-3xl p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-cog text-blue-600 mr-2"></i>í™˜ê²½ ì„¤ì •
                    </h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                            <div class="flex-1">
                                <p class="font-medium text-gray-800 mb-1">
                                    <i class="fas fa-bell text-blue-600 mr-2"></i>ì•Œë¦¼ ë°›ê¸°
                                </p>
                                <p class="text-sm text-gray-500">ìƒˆë¡œìš´ ë©”ì‹œì§€ ë° ì—…ë°ì´íŠ¸ ì•Œë¦¼</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settingNotifications">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                            <div class="flex-1">
                                <p class="font-medium text-gray-800 mb-1">
                                    <i class="fas fa-envelope text-green-600 mr-2"></i>ì´ë©”ì¼ ì•Œë¦¼
                                </p>
                                <p class="text-sm text-gray-500">ì¤‘ìš” ì•Œë¦¼ì„ ì´ë©”ì¼ë¡œ ë°›ê¸°</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settingEmailAlerts">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                            <div class="flex-1">
                                <p class="font-medium text-gray-800 mb-1">
                                    <i class="fas fa-moon text-purple-600 mr-2"></i>ë‹¤í¬ ëª¨ë“œ
                                </p>
                                <p class="text-sm text-gray-500">ì–´ë‘ìš´ í…Œë§ˆ ì‚¬ìš©</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settingDarkMode">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="p-4 bg-gray-50 rounded-xl">
                            <label class="block font-medium text-gray-800 mb-3">
                                <i class="fas fa-language text-orange-600 mr-2"></i>ì–¸ì–´ ì„¤ì •
                            </label>
                            <select id="settingLanguage" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition">
                                <option value="ko">í•œêµ­ì–´</option>
                                <option value="en">English</option>
                                <option value="ja">æ—¥æœ¬èª</option>
                            </select>
                        </div>
                        
                        <button onclick="saveSettings()" class="w-full bg-green-600 text-white py-4 rounded-xl hover:bg-green-700 transition font-medium shadow-lg">
                            <i class="fas fa-save mr-2"></i>ì„¤ì • ì €ì¥
                        </button>
                    </div>
                </div>
            </div>

            <!-- ê³„ì • ë³´ì•ˆ íƒ­ -->
            <div id="content-security" class="tab-content">
                <div class="glass-card rounded-3xl p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-shield-alt text-purple-600 mr-2"></i>ê³„ì • ë³´ì•ˆ
                    </h3>
                    
                    <div class="space-y-4">
                        <!-- ê³„ì • ì •ë³´ -->
                        <div class="p-6 bg-blue-50 rounded-2xl border-2 border-blue-200">
                            <div class="flex items-start gap-3">
                                <i class="fas fa-info-circle text-blue-600 text-2xl mt-1"></i>
                                <div class="flex-1">
                                    <p class="font-bold text-blue-900 mb-3 text-lg">ê³„ì • ì •ë³´</p>
                                    <div class="space-y-2">
                                        <p class="text-sm text-blue-800">
                                            <strong>ê°€ì…ì¼:</strong> <span id="joinDate">-</span>
                                        </p>
                                        <p class="text-sm text-blue-800">
                                            <strong>ì„±í•¨:</strong> <span id="userRealName">-</span>
                                        </p>
                                        <p class="text-sm text-blue-800">
                                            <strong>ì´ë©”ì¼:</strong> <span id="userEmail2">-</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ -->
                        <div class="p-6 bg-gray-50 rounded-2xl hover:bg-gray-100 transition">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="font-bold text-gray-800 mb-1">
                                        <i class="fas fa-key text-purple-600 mr-2"></i>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
                                    </p>
                                    <p class="text-sm text-gray-600">ë³´ì•ˆì„ ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”</p>
                                </div>
                                <button onclick="openModal('changePasswordModal')" class="bg-purple-600 text-white px-5 py-2 rounded-lg hover:bg-purple-700 transition shadow-lg">
                                    <i class="fas fa-edit mr-2"></i>ë³€ê²½
                                </button>
                            </div>
                        </div>
                        
                        <!-- íšŒì› íƒˆí‡´ -->
                        <div class="p-6 bg-red-50 rounded-2xl border-2 border-red-200">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="font-bold text-red-900 mb-1">
                                        <i class="fas fa-user-times text-red-600 mr-2"></i>íšŒì› íƒˆí‡´
                                    </p>
                                    <p class="text-sm text-red-700">ëª¨ë“  ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤</p>
                                </div>
                                <button onclick="deleteAccount()" class="bg-red-600 text-white px-5 py-2 rounded-lg hover:bg-red-700 transition shadow-lg">
                                    <i class="fas fa-trash mr-2"></i>íƒˆí‡´
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- êµ¬ë… ê´€ë¦¬ íƒ­ -->
            <div id="content-subscription" class="tab-content">
                <div class="glass-card rounded-3xl p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-crown text-yellow-500 mr-2"></i>êµ¬ë… ê´€ë¦¬
                    </h3>
                    
                    <!-- í˜„ì¬ í”Œëœ -->
                    <div class="mb-8 p-6 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl text-white shadow-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-sm opacity-90 mb-1">í˜„ì¬ í”Œëœ</p>
                                <p class="text-4xl font-bold" id="currentPlan">Free</p>
                            </div>
                            <i class="fas fa-crown text-6xl opacity-30"></i>
                        </div>
                        <p class="text-sm opacity-90">ë¬´ë£Œ í”Œëœìœ¼ë¡œ ê¸°ë³¸ ê¸°ëŠ¥ì„ ì‚¬ìš©ì¤‘ì…ë‹ˆë‹¤</p>
                    </div>
                    
                    <!-- í”Œëœ ì„ íƒ -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Free Plan -->
                        <div class="p-6 border-2 border-gray-200 rounded-2xl bg-white hover:shadow-xl transition">
                            <div class="text-center mb-4">
                                <h4 class="text-2xl font-bold text-gray-800 mb-2">Free</h4>
                                <p class="text-4xl font-bold text-gray-900">â‚©0<span class="text-lg font-normal text-gray-600">/ì›”</span></p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                    <span>ì›” 10ê°œ ì‹ë¬¼ ë“±ë¡</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                    <span>ê¸°ë³¸ ì±„íŒ… ê¸°ëŠ¥</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                    <span>ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                    <span>ê¸°ë³¸ ê²€ìƒ‰ ê¸°ëŠ¥</span>
                                </li>
                            </ul>
                            <button class="w-full bg-gray-200 text-gray-600 py-3 rounded-xl font-medium cursor-not-allowed">
                                í˜„ì¬ í”Œëœ
                            </button>
                        </div>
                        
                        <!-- Pro Plan -->
                        <div class="p-6 border-2 border-yellow-400 rounded-2xl bg-gradient-to-br from-yellow-50 to-orange-50 hover:shadow-xl transition transform hover:scale-105">
                            <div class="text-center mb-4">
                                <div class="inline-block bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-4 py-1 rounded-full text-xs font-bold mb-3 shadow-lg">
                                    â­ PREMIUM
                                </div>
                                <h4 class="text-2xl font-bold text-gray-800 mb-2">Pro</h4>
                                <p class="text-4xl font-bold text-gray-900">â‚©9,900<span class="text-lg font-normal text-gray-600">/ì›”</span></p>
                            </div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span><strong>ë¬´ì œí•œ</strong> ì‹ë¬¼ ë“±ë¡</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span><strong>ìš°ì„  ë…¸ì¶œ</strong> í˜œíƒ</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span>ê³ ê¸‰ í†µê³„ ë¶„ì„</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span>ì „ë¬¸ê°€ ë°°ì§€</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span>ê´‘ê³  ì œê±°</span>
                                </li>
                                <li class="flex items-center gap-2 text-sm">
                                    <i class="fas fa-crown text-yellow-600"></i>
                                    <span>ìš°ì„  ê³ ê° ì§€ì›</span>
                                </li>
                            </ul>
                            <button class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white py-3 rounded-xl font-medium hover:from-yellow-500 hover:to-orange-600 transition shadow-lg">
                                <i class="fas fa-crown mr-2"></i>Proë¡œ ì—…ê·¸ë ˆì´ë“œ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="editProfileModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-user-edit text-green-600 mr-2"></i>í”„ë¡œí•„ ìˆ˜ì •
                </h3>
                <button onclick="closeModal('editProfileModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-user mr-1"></i>ë‹‰ë„¤ì„
                    </label>
                    <input type="text" id="editUsername" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-id-card mr-1"></i>ì„±í•¨
                    </label>
                    <input type="text" id="editRealName" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition" placeholder="ì‹¤ëª… ì…ë ¥">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-map-marker-alt mr-1"></i>ì§€ì—­
                    </label>
                    <input type="text" id="editLocation" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition" placeholder="ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬">
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button onclick="closeModal('editProfileModal')" class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-medium">
                        ì·¨ì†Œ
                    </button>
                    <button onclick="saveProfile()" class="flex-1 bg-green-600 text-white py-3 rounded-xl hover:bg-green-700 transition font-medium shadow-lg">
                        <i class="fas fa-save mr-2"></i>ì €ì¥
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ëª¨ë‹¬ -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-key text-purple-600 mr-2"></i>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
                </h3>
                <button onclick="closeModal('changePasswordModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-lock mr-1"></i>í˜„ì¬ ë¹„ë°€ë²ˆí˜¸
                    </label>
                    <input type="password" id="currentPassword" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none transition" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-lock mr-1"></i>ìƒˆ ë¹„ë°€ë²ˆí˜¸
                    </label>
                    <input type="password" id="newPassword" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none transition" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-600 mb-2">
                        <i class="fas fa-lock mr-1"></i>ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
                    </label>
                    <input type="password" id="confirmPassword" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none transition" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
                </div>
                
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                    <p class="text-sm text-yellow-800">
                        <i class="fas fa-info-circle mr-1"></i>
                        ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤
                    </p>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button onclick="closeModal('changePasswordModal')" class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-medium">
                        ì·¨ì†Œ
                    </button>
                    <button onclick="changePassword()" class="flex-1 bg-purple-600 text-white py-3 rounded-xl hover:bg-purple-700 transition font-medium shadow-lg">
                        <i class="fas fa-check mr-2"></i>ë³€ê²½
                    </button>
                </div>
            </div>
        </div>
    </div>

<<<<<<< HEAD
    <!-- ìˆ¨ê²¨ì§„ í”„ë¡œí•„ ì´ë¯¸ì§€ (í—¤ë”ìš©) 
=======
    <!-- ìˆ¨ê²¨ì§„ í”„ë¡œí•„ ì´ë¯¸ì§€ (í—¤ë”ìš©) 
>>>>>>> a964570cfdcb6b366c47968111b5d242b0c895f7
